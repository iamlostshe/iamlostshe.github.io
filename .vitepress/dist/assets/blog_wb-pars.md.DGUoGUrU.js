import{_ as i,c as a,o as t,ae as p}from"./chunks/framework.BD_Yrv4e.js";const r=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"blog/wb-pars.md","filePath":"blog/wb-pars.md"}'),e={name:"blog/wb-pars.md"};function n(l,s,o,h,d,k){return t(),a("div",null,[...s[0]||(s[0]=[p('<p>мне часто пишут люди, с просьбой что-либо спарсить для них, часто с маркетплейсов.</p><p>недавно, у меня так появился новый интересный проект:</p><p>есть расширение для браузера, которое предоставлет закрытую информацию по товарам, например, выручка, потери и многое другое для одного популярного маркетплейса.</p><p>их официальная версия, что-то типа: <code>&quot;эти данные приблизительные, рассчитанные на основе данных об остатках&quot;</code>.</p><p>то есть (предположительно) они сгружают всю базу товаров маркетплейса (как показали мои эксперементы это вполне возможно).</p><p>затем анализируют данные об остатках по секретным формулам (а может быть отслеживают динамику остатков товара), собирают бд (из которой в свою очередь подтягивает инфу в <code>api</code> и оттуда забирает расширение).</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">marketplace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> анализатор</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> бд</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> api</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> расширение</span></span></code></pre></div><p>звучит логично.</p><p>тупить формулы или хранить базу у меня желания/возможностей нет, так что будем парсить <code>api</code> расширения.</p><p>интересно, что при работе с расширением, в панели <code>&quot;Сеть&quot;</code> / <code>&quot;Network&quot;</code> не детектится никаких запросов (не знаю, намеренно ли это сделано или запросы всех расширений скрываются, но раньше я точно видел запросы от других расширений).</p><p>значит настало время для <strong>реверс инженеринга</strong>.</p><p>скачал расширение в формате <code>.zip</code>, оно оказалось минифицированым (опять же, не знаю было ли это сделано специально или магазин расширений минифицирует всё по кд).</p><p>решил, ради интереса попробовать заставить gpt сделать swagger для <code>api</code> расширения.</p><p>на удивение получилось.. отлично! пара методов, не работают (не факт, что по вине <code>gpt</code>), но это уже хорошо, не придётся копаться в минифицированом коде!</p><p>но меня интересовал только один метод: получение статистики по id товаров маркетплейса. и такой был найден.</p><p>авторизация в <code>api</code> сделана по принципу (заботливо оставлена <code>gpt</code> в <code>swagger</code>):</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Authorization</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Bearer &lt;token&gt;</span></span></code></pre></div><p>а token можно забрать из cookie расширения в dev tools. кстати, тут челы решили максимально прикольнуться и сделали токен, аж на 1193 символа (по краней мере у меня так), при чем алфавит такой:</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[\\</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">.0-9A-Za-z]</span></span></code></pre></div><p>совсем не жалеют бд..</p><p>итог: проектик отдан.</p>',21)])])}const g=i(e,[["render",n]]);export{r as __pageData,g as default};
